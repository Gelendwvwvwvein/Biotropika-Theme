(()=>{"use strict";const e=window.wp.blocks,i=window.wp.i18n,o=window.wp.blockEditor,t=window.wp.components,l=window.wp.data,n=window.ReactJSXRuntime;(0,e.registerBlockType)("biotropika/video-slider-block",{edit:function({attributes:e,setAttributes:r}){const{mode:s,selectAllInterviews:a,items:c,interviews:d}=e,p=(0,o.useBlockProps)(),b=(0,l.useSelect)(e=>e("core").getEntityRecords("postType","interview",{per_page:-1}),[])||[],k=(e,i,o)=>{const t=c.slice();t[e][i]=o,r({items:t})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o.InspectorControls,{children:[(0,n.jsx)(t.PanelBody,{title:(0,i.__)("Режим блока","biotropika"),initialOpen:!0,children:(0,n.jsx)(t.ToggleControl,{label:(0,i.__)("Custom‑режим","biotropika"),checked:"custom"===s,onChange:()=>r({mode:"custom"===s?"interview":"custom"})})}),"interview"===s&&(0,n.jsxs)(t.PanelBody,{title:(0,i.__)("Интервью","biotropika"),initialOpen:!0,children:[(0,n.jsx)(t.ToggleControl,{label:(0,i.__)("Выбрать все интервью","biotropika"),checked:a,onChange:e=>r({selectAllInterviews:e})}),!a&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.PanelRow,{children:(0,i.__)("Выберите интервью:","biotropika")}),0===b.length&&(0,n.jsx)(t.PanelRow,{children:(0,i.__)("Нет доступных интервью.","biotropika")}),b.map(e=>(0,n.jsx)(t.CheckboxControl,{label:e.title.rendered,checked:d.includes(e.id),onChange:i=>r({interviews:i?[...d,e.id]:d.filter(i=>i!==e.id)})},e.id))]})]})]}),(0,n.jsxs)("div",{...p,children:["custom"===s&&c.map((e,l)=>(0,n.jsxs)(t.PanelBody,{title:`${(0,i.__)("Слайд","biotropika")} ${l+1}`,initialOpen:!1,children:[(0,n.jsx)(t.PanelRow,{children:(0,n.jsx)(o.MediaUploadCheck,{children:(0,n.jsx)(o.MediaUpload,{onSelect:e=>k(l,"previewUrl",e.url),allowedTypes:["image"],render:({open:o})=>(0,n.jsx)(t.Button,{onClick:o,isSecondary:!0,children:e.previewUrl?(0,i.__)("Изменить превью","biotropika"):(0,i.__)("Выбрать превью","biotropika")})})})}),e.previewUrl&&(0,n.jsx)("img",{src:e.previewUrl,alt:"",style:{display:"block",maxWidth:"100%",margin:"10px 0"}}),(0,n.jsx)(t.TextControl,{label:(0,i.__)("URL видео","biotropika"),value:e.videoUrl,onChange:e=>k(l,"videoUrl",e)}),(0,n.jsx)(t.TextControl,{label:(0,i.__)("Заголовок","biotropika"),value:e.title,onChange:e=>k(l,"title",e)}),(0,n.jsx)(t.BaseControl,{label:(0,i.__)("Текст слайда","biotropika"),children:(0,n.jsx)("div",{className:"slide__content-wrapper",children:(0,n.jsx)(o.InnerBlocks,{allowedBlocks:["core/paragraph","core/heading"],templateLock:!1})})}),(0,n.jsx)(t.TextControl,{label:(0,i.__)("Текст кнопки","biotropika"),value:e.buttonText,onChange:e=>k(l,"buttonText",e)}),(0,n.jsx)(t.TextControl,{label:(0,i.__)("Ссылка кнопки","biotropika"),value:e.buttonLink,onChange:e=>k(l,"buttonLink",e)}),(0,n.jsx)(t.PanelRow,{children:(0,n.jsx)(t.Button,{isLink:!0,isDestructive:!0,onClick:()=>(e=>{const i=c.slice();i.splice(e,1),r({items:i})})(l),children:(0,i.__)("Удалить слайд","biotropika")})})]},l)),"custom"===s&&(0,n.jsx)(t.PanelRow,{children:(0,n.jsx)(t.Button,{isPrimary:!0,onClick:()=>{r({items:[...c,{previewUrl:"",videoUrl:"",title:"",buttonText:"",buttonLink:""}]})},children:(0,i.__)("Добавить слайд","biotropika")})}),"interview"===s&&(0,n.jsx)("p",{children:a?(0,i.__)("Показываем все интервью","biotropika"):(0,i.__)("Показываем выбранные интервью","biotropika")})]})]})},save:()=>null})})();